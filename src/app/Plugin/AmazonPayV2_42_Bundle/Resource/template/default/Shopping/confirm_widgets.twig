{#
Amazon Pay V2 for EC-CUBE4.2
Copyright(c) 2023 EC-CUBE CO.,LTD. all rights reserved.

https://www.ec-cube.co.jp/

This program is not free software.
It applies to terms of service.
#}

<link rel="stylesheet" href="{{ asset('assets/css/amazon_shopping_v2.css') }}">

{% block javascript %}
<script>
$(function () {
    $('button.ec-blockBtn--action').addClass('amazon_pay_button');
    
    // submit
    $('#shopping-form').attr('action', '{{ url("amazon_pay_shopping_checkout") }}');

    // back
    $('.ec-blockBtn--cancel').attr('href', '{{ url("amazon_pay_shopping") }}');

    //スクロール処理上書き
    $('.pagetop').hide();

    $(window).on('scroll', function() {
        // ページトップフェードイン
        if ($(this).scrollTop() > 300) {
            $('.pagetop').fadeIn();
        } else {
            $('.pagetop').fadeOut();
        }

        // PC表示の時のみに適用
        if (window.innerWidth > 767) {

            var side = $(".ec-orderRole__summary"),
                wrap = $("#shopping-form"),
                amazon_wrap = $('.amazon_customer_regist_v2'),
                min_move = wrap.offset().top,
                max_move = wrap.height(),
                amazon_move = amazon_wrap.height(),
                margin_bottom = max_move - min_move;

            var scrollTop = $(window).scrollTop();
            if (scrollTop > min_move && scrollTop < max_move && amazon_move > 0) {
                side.css({"margin-top": 0});
            } else if (scrollTop > max_move) {
                side.css({"margin-top": margin_bottom});
            }
        }
    });
});
</script>
{% endblock %}
